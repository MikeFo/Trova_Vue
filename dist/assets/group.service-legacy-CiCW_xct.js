!function(){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},r(e)}function e(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),n.push.apply(n,t)}return n}function n(r){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach(function(e){t(r,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function t(r,e,n){return(e=s(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,e,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function a(n,t,o,i){var a=t&&t.prototype instanceof s?t:s,p=Object.create(a.prototype);return u(p,"_invoke",function(n,t,o){var u,i,a,s=0,p=o||[],l=!1,f={p:0,n:0,v:r,a:v,f:v.bind(r,4),d:function(e,n){return u=e,i=0,a=r,f.n=n,c}};function v(n,t){for(i=n,a=t,e=0;!l&&s&&!o&&e<p.length;e++){var o,u=p[e],v=f.p,d=u[2];n>3?(o=d===t)&&(a=u[(i=u[4])?5:(i=3,3)],u[4]=u[5]=r):u[0]<=v&&((o=n<2&&v<u[1])?(i=0,f.v=t,f.n=u[1]):v<d&&(o=n<3||u[0]>t||t>d)&&(u[4]=n,u[5]=t,f.n=d,i=0))}if(o||n>1)return c;throw l=!0,t}return function(o,p,d){if(s>1)throw TypeError("Generator is already running");for(l&&1===p&&v(p,d),i=p,a=d;(e=i<2?r:a)||!l;){u||(i?i<3?(i>1&&(f.n=-1),v(i,a)):f.n=a:f.v=a);try{if(s=2,u){if(i||(o="next"),e=u[o]){if(!(e=e.call(u,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,i<2&&(i=0)}else 1===i&&(e=u.return)&&e.call(u),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);u=r}else if((e=(l=f.n<0)?a:n.call(t,f))!==c)break}catch(e){u=r,i=1,a=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),p}var c={};function s(){}function p(){}function l(){}e=Object.getPrototypeOf;var f=[][t]?e(e([][t]())):(u(e={},t,function(){return this}),e),v=l.prototype=s.prototype=Object.create(f);function d(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,l):(r.__proto__=l,u(r,i,"GeneratorFunction")),r.prototype=Object.create(v),r}return p.prototype=l,u(v,"constructor",l),u(l,"constructor",p),p.displayName="GeneratorFunction",u(l,i,"GeneratorFunction"),u(v),u(v,i,"Generator"),u(v,t,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(o=function(){return{w:a,m:d}})()}function u(r,e,n,t){var o=Object.defineProperty;try{o({},"",{})}catch(r){o=0}u=function(r,e,n,t){function i(e,n){u(r,e,function(r){return this._invoke(e,n,r)})}e?o?o(r,e,{value:n,enumerable:!t,configurable:!t,writable:!t}):r[e]=n:(i("next",0),i("throw",1),i("return",2))},u(r,e,n,t)}function i(r,e,n,t,o,u,i){try{var a=r[u](i),c=a.value}catch(r){return void n(r)}a.done?e(c):Promise.resolve(c).then(t,o)}function a(r){return function(){var e=this,n=arguments;return new Promise(function(t,o){var u=r.apply(e,n);function a(r){i(u,t,o,a,c,"next",r)}function c(r){i(u,t,o,a,c,"throw",r)}a(void 0)})}}function c(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,s(t.key),t)}}function s(e){var n=function(e,n){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==r(n)?n:n+""}System.register(["./index-legacy-D3_iwoP0.js"],function(r,e){"use strict";var t;return{setters:[function(r){t=r.x}],execute:function(){var e=function(){return r=function r(){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r)},e=[{key:"getGroups",value:(h=a(o().m(function r(e,n){var u,i,a,c,s,p,l,f,v,d,g,y;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.get("/groups?communityId=".concat(e,"&userId=").concat(n));case 1:return u=r.v,r.a(2,u||[]);case 2:if(r.p=2,g=r.v,p=(null===(i=g.response)||void 0===i||null===(i=i.data)||void 0===i||null===(i=i.error)||void 0===i?void 0:i.message)||(null===(a=g.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.message)||g.message,console.error("[GroupService] Failed to fetch groups:",p),console.error("[GroupService] Error details:",null===(c=g.response)||void 0===c?void 0:c.data),500!==g.status&&500!==(null===(s=g.response)||void 0===s?void 0:s.status)){r.n=6;break}return console.log("[GroupService] Main endpoint returned 500, trying alternative endpoint..."),r.p=3,r.n=4,t.get("/communities/".concat(e,"/groups"));case 4:return l=r.v,console.log("[GroupService] Successfully fetched groups via alternative endpoint"),r.a(2,l||[]);case 5:return r.p=5,y=r.v,d=(null===(f=y.response)||void 0===f||null===(f=f.data)||void 0===f||null===(f=f.error)||void 0===f?void 0:f.message)||(null===(v=y.response)||void 0===v||null===(v=v.data)||void 0===v?void 0:v.message)||y.message,console.error("[GroupService] Alternative endpoint also failed:",d),r.a(2,[]);case 6:return r.a(2,[])}},r,null,[[3,5],[0,2]])})),function(r,e){return h.apply(this,arguments)})},{key:"getGroup",value:(y=a(o().m(function r(e){var n,u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.get("/groups/".concat(e));case 1:return n=r.v,r.a(2,n);case 2:return r.p=2,u=r.v,console.error("Failed to fetch group:",u),r.a(2,null)}},r,null,[[0,2]])})),function(r){return y.apply(this,arguments)})},{key:"getGroupsByUser",value:(g=a(o().m(function r(e){var n,u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.get("/groups/user/".concat(e));case 1:return n=r.v,r.a(2,n||[]);case 2:return r.p=2,u=r.v,console.error("Failed to fetch user groups:",u),r.a(2,[])}},r,null,[[0,2]])})),function(r){return g.apply(this,arguments)})},{key:"joinGroup",value:(d=a(o().m(function r(e,n){var u,i,a,c,s,p,l,f;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,console.log("[GroupService] Joining group:",n,"for user:",e),r.p=1,r.n=2,t.post("/groups/".concat(n,"/assign"),{userId:e});case 2:return u=r.v,console.log("[GroupService] Successfully joined group (via /assign):",n),r.a(2,u);case 3:if(r.p=3,404!==(p=r.v).status&&404!==(null===(i=p.response)||void 0===i?void 0:i.status)){r.n=9;break}return console.log("[GroupService] /assign endpoint not found, trying /join endpoint..."),r.p=4,r.n=5,t.post("/groups/join",{userId:e,groupId:n});case 5:return a=r.v,console.log("[GroupService] Successfully joined group (via /join):",n),r.a(2,a);case 6:if(r.p=6,404!==(l=r.v).status&&404!==(null===(c=l.response)||void 0===c?void 0:c.status)){r.n=8;break}return console.log("[GroupService] /join endpoint not found, trying /groups/:id/join..."),r.n=7,t.post("/groups/".concat(n,"/join"),{userId:e});case 7:return s=r.v,console.log("[GroupService] Successfully joined group (via /groups/:id/join):",n),r.a(2,s);case 8:throw l;case 9:throw p;case 10:throw r.p=10,f=r.v,console.error("[GroupService] Failed to join group:",f),f;case 11:return r.a(2)}},r,null,[[4,6],[1,3],[0,10]])})),function(r,e){return d.apply(this,arguments)})},{key:"leaveGroup",value:(v=a(o().m(function r(e,n){var u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.post("/groups/leave",{userId:e,groupId:n});case 1:r.n=3;break;case 2:throw r.p=2,u=r.v,console.error("Failed to leave group:",u),u;case 3:return r.a(2)}},r,null,[[0,2]])})),function(r,e){return v.apply(this,arguments)})},{key:"createGroup",value:(f=a(o().m(function r(e){var n,u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.post("/groups/new",e);case 1:return n=r.v,r.a(2,n);case 2:throw r.p=2,u=r.v,console.error("Failed to create group:",u),u;case 3:return r.a(2)}},r,null,[[0,2]])})),function(r){return f.apply(this,arguments)})},{key:"updateGroup",value:(l=a(o().m(function r(e,u){var i,a,c;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,i=n(n({},u),{},{id:e}),r.n=1,t.patch("/groups/edit",i);case 1:return a=r.v,r.a(2,a);case 2:throw r.p=2,c=r.v,console.error("Failed to update group:",c),c;case 3:return r.a(2)}},r,null,[[0,2]])})),function(r,e){return l.apply(this,arguments)})},{key:"getOrCreateConvo",value:(p=a(o().m(function r(e){var n,u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.post("/groups/get-or-create-convo-id",{groupId:e});case 1:return n=r.v,r.a(2,{conversationId:n.conversationId||n.convoId||""});case 2:throw r.p=2,u=r.v,console.error("Failed to get/create group conversation:",u),u;case 3:return r.a(2)}},r,null,[[0,2]])})),function(r){return p.apply(this,arguments)})},{key:"shareGroup",value:(s=a(o().m(function r(e){var n,u;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,t.post("/groups/".concat(e,"/share"));case 1:return n=r.v,r.a(2,n);case 2:throw r.p=2,u=r.v,console.error("Failed to share group:",u),u;case 3:return r.a(2)}},r,null,[[0,2]])})),function(r){return s.apply(this,arguments)})},{key:"getStarredGroups",value:(i=a(o().m(function r(e,n){var u,i,a,c,s,p,l,f;return o().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,u="/groups/user/".concat(e,"/starred"),null!=n&&(u+="?communityId=".concat(n)),r.n=1,t.get(u);case 1:return i=r.v,r.a(2,i||[]);case 2:if(r.p=2,404!==(l=r.v).status&&404!==(null===(a=l.response)||void 0===a?void 0:a.status)){r.n=7;break}return r.p=3,r.n=4,this.getGroupsByUser(e);case 4:return c=r.v,s=c.filter(function(r){return!0===r.isFavorite}),null!=n&&(s=s.filter(function(r){return r.communityId===n})),r.a(2,s);case 5:if(r.p=5,404!==(f=r.v).status&&404!==(null===(p=f.response)||void 0===p?void 0:p.status)){r.n=6;break}return r.a(2,[]);case 6:return console.error("Fallback method failed:",f),r.a(2,[]);case 7:return console.error("Failed to fetch starred groups:",l),r.a(2,[])}},r,this,[[3,5],[0,2]])})),function(r,e){return i.apply(this,arguments)})}],e&&c(r.prototype,e),u&&c(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,e,u,i,s,p,l,f,v,d,g,y,h}();r("GroupService",e);r("groupService",new e)}}})}();
