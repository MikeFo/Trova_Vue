import{x as X,F as H,v as z,a1 as Y,r as b,a2 as N,a4 as L,G as J,Y as i,O as s,ag as f,a8 as y,N as l,L as n,Z as G,aa as P,ab as O,a6 as h,be as ee,U as te,X as V,J as w,bf as se,R as o,I as B,W as T,ai as E,a0 as U,aX as ne,bg as j,H as K,aV as oe,aD as Q,bh as ae,aE as ie,bi as le,bj as ce,V as ue,af as Z,a_ as R,M as re,Q as me}from"./index-CkJ7yJ3n.js";import{groupService as de}from"./group.service-CH2Rgjsj.js";import{eventService as ve}from"./event.service-D7cjacjh.js";class ye{async getCommunityActivity(u){var d;try{return(await X.get("/communities/".concat(u,"/activity"))||[]).sort((m,r)=>{const _=new Date(m.timestamp).getTime();return new Date(r.timestamp).getTime()-_})}catch(v){return v.status===404||((d=v.response)==null?void 0:d.status)===404?[]:(console.error("Failed to fetch community activity:",v),[])}}async getAllCommunitiesActivity(u){var d;try{return(await X.get("/users/".concat(u,"/activity/all"))||[]).sort((m,r)=>{const _=new Date(m.timestamp).getTime();return new Date(r.timestamp).getTime()-_})}catch(v){return v.status===404||((d=v.response)==null?void 0:d.status)===404?[]:(console.error("Failed to fetch all communities activity:",v),[])}}}const q=new ye,pe={class:"activity-feed-section"},_e={class:"section-header"},he={class:"section-title"},ge={key:0,class:"loading-state"},fe={key:1,class:"activity-feed"},$e={key:0,class:"date-separator"},be={class:"activity-content"},we={class:"activity-avatar"},ke=["src","alt"],Ce={key:1,class:"avatar-placeholder"},Ie={class:"activity-message"},De={class:"message-header"},Se={class:"author-name"},Te={class:"message-time"},Ne={class:"message-text"},Ae={key:2,class:"empty-state"},Fe={class:"empty-icon"},Me={class:"empty-title"},Ve={class:"empty-description"},Be={key:3,class:"message-input-container"},He=H({__name:"HomeActivityFeed",props:{communityId:{default:null}},setup(A){const u=A,d=z(),v=Y(),m=b([]),r=b(!1),_=b(""),p=N(()=>u.communityId===null),I=N(()=>v.currentCommunityName);function S(c){const t=c.split(" ");return t.length>=2?(t[0][0]+t[t.length-1][0]).toUpperCase():c.substring(0,2).toUpperCase()}function $(c){const t=new Date(c),a=new Date().getTime()-t.getTime(),g=Math.floor(a/6e4),D=Math.floor(a/36e5),C=Math.floor(a/864e5);return g<1?"Just now":g<60?"".concat(g,"m ago"):D<24?"".concat(D,"h ago"):C<7?"".concat(C,"d ago"):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function k(c){const t=new Date(c),e=new Date,a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),g=new Date(t.getFullYear(),t.getMonth(),t.getDate()),D=a.getTime()-g.getTime(),C=Math.ceil(D/(1e3*60*60*24));return C===0?"Today":C===1?"Yesterday":C<7?t.toLocaleDateString("en-US",{weekday:"long"}):t.toLocaleDateString("en-US",{month:"long",day:"numeric",year:t.getFullYear()!==e.getFullYear()?"numeric":void 0})}function F(c,t){if(t===0)return!0;const e=new Date(c.timestamp),a=new Date(m.value[t-1].timestamp),g=new Date(e.getFullYear(),e.getMonth(),e.getDate()),D=new Date(a.getFullYear(),a.getMonth(),a.getDate());return g.getTime()!==D.getTime()}async function M(){var t;const c=(t=d.user)==null?void 0:t.id;if(!c){m.value=[];return}r.value=!0;try{if(u.communityId===null){const e=await q.getAllCommunitiesActivity(c);m.value=e}else if(u.communityId){const e=await q.getCommunityActivity(u.communityId);m.value=e}else m.value=[]}catch(e){console.error("[HomeActivityFeed] Failed to load activity:",e),m.value=[]}finally{r.value=!1}}return L(()=>u.communityId,()=>{M()}),J(()=>{M()}),(c,t)=>(o(),i("div",pe,[s("div",_e,[s("h2",he,y(p.value?"All Communities":I.value),1)]),r.value?(o(),i("div",ge,[l(n(G),{name:"crescent"}),t[1]||(t[1]=s("p",null,"Loading activity...",-1))])):m.value.length>0?(o(),i("div",fe,[(o(!0),i(P,null,O(m.value,(e,a)=>{var g,D,C;return o(),i("div",{key:e.id||a,class:"activity-item"},[F(e,a)?(o(),i("div",$e,y(k(e.timestamp)),1)):f("",!0),s("div",be,[s("div",we,[(g=e.author)!=null&&g.profilePicture?(o(),i("img",{key:0,src:e.author.profilePicture,alt:e.author.fullName},null,8,ke)):(o(),i("div",Ce,y(S(((D=e.author)==null?void 0:D.fullName)||"U")),1))]),s("div",Ie,[s("div",De,[s("span",Se,y(((C=e.author)==null?void 0:C.fullName)||"Unknown"),1),s("span",Te,y($(e.timestamp)),1)]),s("p",Ne,y(e.content),1),p.value&&e.communityName?(o(),B(n(E),{key:0,color:"primary",class:"community-label"},{default:w(()=>[T(y(e.communityName),1)]),_:2},1024)):f("",!0)])])])}),128))])):(o(),i("div",Ae,[s("div",Fe,[l(n(h),{icon:n(ee)},null,8,["icon"])]),s("h3",Me,y(p.value?"No activity across communities":"No activity in ".concat(I.value)),1),s("p",Ve,y(p.value?"Activity from all your communities will appear here":"Community updates and messages will appear here"),1)])),p.value?f("",!0):(o(),i("div",Be,[l(n(te),{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),placeholder:"Send a message...",class:"message-input",disabled:!0},null,8,["modelValue"]),l(n(V),{fill:"clear",class:"send-button",disabled:!0},{default:w(()=>[l(n(h),{icon:n(se)},null,8,["icon"])]),_:1})]))]))}}),Le=U(He,[["__scopeId","data-v-3e90b7c3"]]),Ue={class:"groups-section"},xe={class:"section-header"},Ee={key:0,class:"loading-state"},Ye={key:1,class:"groups-list"},Ge=["onClick"],Pe={class:"group-image"},Oe=["src","alt"],Re={key:1,class:"group-placeholder"},ze={class:"group-content"},Je={class:"group-header"},Ke={class:"group-name"},We={key:0,class:"group-description"},Xe={class:"group-footer"},je={key:0,class:"member-count"},Qe={key:2,class:"empty-state"},Ze={class:"empty-icon"},qe={class:"empty-title"},et={class:"empty-description"},tt=H({__name:"HomeGroupsSection",props:{communityId:{default:null}},setup(A){const u=A,d=K(),v=z(),m=Y(),r=b([]),_=b(!1),p=N(()=>u.communityId===null),I=N(()=>m.currentCommunityName);function S(c){const t=m.getCommunityById(c);return(t==null?void 0:t.name)||"Community"}function $(c,t){return c.length<=t?c:c.substring(0,t)+"..."}function k(c){d.push("/tabs/groups/".concat(c))}function F(c){d.push(c)}async function M(){var t;const c=(t=v.user)==null?void 0:t.id;if(!c){r.value=[];return}_.value=!0;try{const e=await de.getStarredGroups(c,u.communityId||void 0);r.value=e}catch(e){console.error("[HomeGroupsSection] Failed to load groups:",e),r.value=[]}finally{_.value=!1}}return L(()=>u.communityId,()=>{M()}),J(()=>{M()}),(c,t)=>(o(),i("div",Ue,[s("div",xe,[t[3]||(t[3]=s("h2",{class:"section-title"},"Groups",-1)),l(n(V),{fill:"clear",size:"small",class:"see-all-button",onClick:t[0]||(t[0]=e=>F("/tabs/groups"))},{default:w(()=>[t[2]||(t[2]=T(" View all ",-1)),l(n(h),{icon:n(ne),slot:"end"},null,8,["icon"])]),_:1})]),_.value?(o(),i("div",Ee,[l(n(G),{name:"crescent"}),t[4]||(t[4]=s("p",null,"Loading groups...",-1))])):r.value.length>0?(o(),i("div",Ye,[(o(!0),i(P,null,O(r.value,e=>(o(),i("div",{key:e.id,class:"group-card",onClick:a=>k(e.id)},[s("div",Pe,[e.logo||e.logoSmall?(o(),i("img",{key:0,src:e.logo||e.logoSmall,alt:e.name},null,8,Oe)):(o(),i("div",Re,[l(n(h),{icon:n(j)},null,8,["icon"])]))]),s("div",ze,[s("div",Je,[s("h3",Ke,y(e.name),1),e.isFavorite?(o(),B(n(h),{key:0,icon:n(oe),class:"star-icon"},null,8,["icon"])):f("",!0)]),e.bio?(o(),i("p",We,y($(e.bio,80)),1)):f("",!0),s("div",Xe,[e.memberCount!==void 0?(o(),i("span",je,y(e.memberCount)+" "+y(e.memberCount===1?"member":"members"),1)):f("",!0),p.value&&e.communityId?(o(),B(n(E),{key:1,color:"primary",class:"community-badge"},{default:w(()=>[T(y(S(e.communityId)),1)]),_:2},1024)):f("",!0)])])],8,Ge))),128))])):(o(),i("div",Qe,[s("div",Ze,[l(n(h),{icon:n(j)},null,8,["icon"])]),s("h3",qe,y(p.value?"No starred groups":"No starred groups in ".concat(I.value)),1),s("p",et,y(p.value?"Star groups to see them on your homepage":"Star groups in this community to see them here"),1),l(n(V),{fill:"outline",class:"empty-action-button",onClick:t[1]||(t[1]=e=>F("/tabs/groups"))},{default:w(()=>[...t[5]||(t[5]=[T(" Browse Groups ",-1)])]),_:1})]))]))}}),st=U(tt,[["__scopeId","data-v-755b6e00"]]),nt={class:"events-section"},ot={class:"section-header"},at={key:0,class:"loading-state"},it={key:1,class:"events-list"},lt=["onClick"],ct={class:"event-image"},ut=["src","alt"],rt={key:1,class:"event-placeholder"},mt={class:"event-content"},dt={class:"event-name"},vt={class:"event-details"},yt={key:0,class:"event-detail-item"},pt={key:1,class:"event-detail-item"},_t={class:"event-footer"},ht={key:2,class:"empty-state"},gt={class:"empty-icon"},ft={class:"empty-title"},$t={class:"empty-description"},bt=H({__name:"HomeEventsSection",props:{communityId:{default:null}},setup(A){const u=A,d=K(),v=z(),m=Y(),r=b([]),_=b(!1),p=N(()=>u.communityId===null),I=N(()=>m.currentCommunityName),S=N(()=>null);function $(t){const e=m.getCommunityById(t);return(e==null?void 0:e.name)||"Community"}function k(t){const e=new Date(t),a=new Date,g=new Date(a.getFullYear(),a.getMonth(),a.getDate()),C=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-g.getTime(),x=Math.ceil(C/(1e3*60*60*24));if(x===0)return"Today";if(x===1)return"Tomorrow";if(x<7)return"In ".concat(x," days");const W={month:"short",day:"numeric"};return e.getFullYear()!==a.getFullYear()&&(W.year="numeric"),e.toLocaleDateString("en-US",W)}function F(t){d.push("/tabs/events/".concat(t))}function M(t){d.push(t)}async function c(){var e;const t=(e=v.user)==null?void 0:e.id;if(!t){r.value=[];return}_.value=!0;try{const a=await ve.getUpcomingRSVPEvents(t,u.communityId||void 0);r.value=a}catch(a){console.error("[HomeEventsSection] Failed to load events:",a),r.value=[]}finally{_.value=!1}}return L(()=>u.communityId,()=>{c()}),J(()=>{c()}),(t,e)=>(o(),i("div",nt,[s("div",ot,[e[3]||(e[3]=s("h2",{class:"section-title"},"Upcoming Events",-1)),l(n(V),{fill:"clear",size:"small",class:"see-all-button",onClick:e[0]||(e[0]=a=>M("/tabs/events"))},{default:w(()=>[e[2]||(e[2]=T(" View all ",-1)),l(n(h),{icon:n(ne),slot:"end"},null,8,["icon"])]),_:1})]),_.value?(o(),i("div",at,[l(n(G),{name:"crescent"}),e[4]||(e[4]=s("p",null,"Loading events...",-1))])):r.value.length>0?(o(),i("div",it,[(o(!0),i(P,null,O(r.value,a=>(o(),i("div",{key:a.id,class:"event-card",onClick:g=>F(a.id)},[s("div",ct,[S.value?(o(),i("img",{key:0,src:S.value,alt:a.name},null,8,ut)):(o(),i("div",rt,[l(n(h),{icon:n(Q)},null,8,["icon"])]))]),s("div",mt,[s("h3",dt,y(a.name),1),s("div",vt,[a.startTime?(o(),i("div",yt,[l(n(h),{icon:n(ae),class:"detail-icon"},null,8,["icon"]),s("span",null,y(k(a.startTime)),1)])):f("",!0),a.location?(o(),i("div",pt,[l(n(h),{icon:n(ie),class:"detail-icon"},null,8,["icon"]),s("span",null,y(a.location),1)])):f("",!0)]),s("div",_t,[a.userAttending?(o(),B(n(E),{key:0,color:"success",class:"rsvp-badge"},{default:w(()=>[...e[5]||(e[5]=[T(" RSVP'd ",-1)])]),_:1})):f("",!0),p.value&&a.communityId?(o(),B(n(E),{key:1,color:"primary",class:"community-badge"},{default:w(()=>[T(y($(a.communityId)),1)]),_:2},1024)):f("",!0)])])],8,lt))),128))])):(o(),i("div",ht,[s("div",gt,[l(n(h),{icon:n(Q)},null,8,["icon"])]),s("h3",ft,y(p.value?"No upcoming events":"No upcoming events in ".concat(I.value)),1),s("p",$t,y(p.value?"RSVP to events to see them here":"RSVP to events in this community to see them here"),1),l(n(V),{fill:"outline",class:"empty-action-button",onClick:e[1]||(e[1]=a=>M("/tabs/events"))},{default:w(()=>[...e[6]||(e[6]=[T(" View Events ",-1)])]),_:1})]))]))}}),wt=U(bt,[["__scopeId","data-v-fb399dbb"]]),kt={class:"header-content"},Ct={key:0,class:"chatbox-content"},It={class:"message-content"},Dt={key:0,class:"message assistant-message"},St={class:"message-content"},Tt={class:"input-container"},Nt=H({__name:"LLMChatbox",setup(A){const u=b(!1),d=b(""),v=b(!1),m=b([{role:"assistant",content:"Hello! I'm your AI assistant. I can help you find information across your communities, groups, and events. This feature is coming soon!"}]),r=b(null);function _(){u.value=!u.value}async function p(){if(!d.value.trim()||v.value)return;const S=d.value.trim();d.value="",m.value.push({role:"user",content:S}),await R(),I(),v.value=!0,setTimeout(()=>{m.value.push({role:"assistant",content:"This is a placeholder response. The AI assistant feature is coming soon! Once implemented, I'll be able to search across your communities, groups, and events to help you find what you need."}),v.value=!1,R(()=>{I()})},1e3)}function I(){r.value&&(r.value.scrollTop=r.value.scrollHeight)}return L(()=>m.value.length,()=>{R(()=>{I()})}),(S,$)=>(o(),i("div",{class:Z(["llm-chatbox",{collapsed:u.value}])},[s("div",{class:"chatbox-header",onClick:_},[s("div",kt,[l(n(h),{icon:n(ee),class:"header-icon"},null,8,["icon"]),$[1]||($[1]=s("span",{class:"header-title"},"AI Assistant",-1))]),l(n(h),{icon:u.value?n(le):n(ce),class:"collapse-icon"},null,8,["icon"])]),u.value?f("",!0):(o(),i("div",Ct,[s("div",{class:"messages-container",ref_key:"messagesContainer",ref:r},[(o(!0),i(P,null,O(m.value,(k,F)=>(o(),i("div",{key:F,class:Z(["message",{"user-message":k.role==="user","assistant-message":k.role==="assistant"}])},[s("div",It,[s("p",null,y(k.content),1)])],2))),128)),v.value?(o(),i("div",Dt,[s("div",St,[l(n(G),{name:"crescent",class:"loading-spinner"}),$[2]||($[2]=s("p",null,"Thinking...",-1))])])):f("",!0)],512),s("div",Tt,[l(n(te),{modelValue:d.value,"onUpdate:modelValue":$[0]||($[0]=k=>d.value=k),placeholder:"Ask me anything...",class:"chat-input",onKeyup:ue(p,["enter"]),disabled:v.value},null,8,["modelValue","disabled"]),l(n(V),{fill:"clear",class:"send-button",onClick:p,disabled:!d.value.trim()||v.value},{default:w(()=>[l(n(h),{icon:n(se)},null,8,["icon"])]),_:1},8,["disabled"])])]))],2))}}),At=U(Nt,[["__scopeId","data-v-e79849b4"]]),Ft={class:"home-container"},Mt={class:"hero-section"},Vt={class:"welcome-content"},Bt={class:"welcome-subtitle"},Ht={class:"main-content-grid"},Lt={class:"content-column activity-column"},Ut={class:"content-column groups-column"},xt={class:"content-column events-column"},Et=H({__name:"HomePage",setup(A){K();const u=Y(),d=N(()=>u.currentCommunityId),v=N(()=>{if(u.isGlobalView)return"Here's what's happening across all your communities";const m=u.currentCommunityName;return"Here's what's happening in ".concat(m)});return L(()=>u.currentCommunityId,()=>{}),(m,r)=>(o(),B(n(re),null,{default:w(()=>[l(n(me),{fullscreen:!0,class:"home-content"},{default:w(()=>[s("div",Ft,[s("div",Mt,[s("div",Vt,[r[0]||(r[0]=s("h1",{class:"welcome-title"},[T(" Welcome back"),s("span",{class:"highlight"},"!")],-1)),s("p",Bt,y(v.value),1)])]),s("div",Ht,[s("div",Lt,[l(Le,{"community-id":d.value},null,8,["community-id"])]),s("div",Ut,[l(st,{"community-id":d.value},null,8,["community-id"])]),s("div",xt,[l(wt,{"community-id":d.value},null,8,["community-id"]),l(At)])])])]),_:1})]),_:1}))}}),Ot=U(Et,[["__scopeId","data-v-7e68e298"]]);export{Ot as default};
