import{r as w,o as I,e as L}from"./index-CkJ7yJ3n.js";function A(){const i=w(!1),u=w(!1);let g=[];async function y(){var e,s;if(i.value||(s=(e=window.google)==null?void 0:e.maps)!=null&&s.places){i.value=!0;return}return u.value?new Promise(t=>{const n=setInterval(()=>{i.value&&(clearInterval(n),t())},100)}):(u.value=!0,new Promise((t,n)=>{const a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=".concat(L.googleMapsApiKey,"&libraries=places"),a.async=!0,a.defer=!0,a.onload=()=>{i.value=!0,u.value=!1,t()},a.onerror=()=>{u.value=!1,n(new Error("Failed to load Google Maps script"))},document.head.appendChild(a)}))}function b(e,s,t=["locality","sublocality","sublocality_level_1","neighborhood"]){var o;if(!e||!i.value)return null;const n=window.google;if(!((o=n==null?void 0:n.maps)!=null&&o.places))return null;const a=new n.maps.places.Autocomplete(e,{types:t,fields:["place_id","geometry","name","address_components"]});return a.addListener("place_changed",()=>{const c=a.getPlace();if(c.geometry&&c.address_components){const d=h(c);s(d),e.value=""}}),g.push(a),a}function h(e){var v,_;let s="",t="",n="",a="",o="";(v=e.address_components)==null||v.forEach(l=>{l.types.forEach(k=>{switch(k){case"country":o=l.long_name||l.short_name||"";break;case"locality":s=l.long_name||l.short_name||"";break;case"sublocality":case"sublocality_level_1":t=l.long_name||l.short_name||"";break;case"neighborhood":n=l.long_name||l.short_name||"";break;case"administrative_area_level_1":a=l.short_name||l.long_name||"";break}})});const c=n||t||s||e.name||"",d=c,m=o==="United States"?a:o,r=(_=e.geometry)==null?void 0:_.location;if(!r)throw new Error("Place geometry is missing");const p=r.lat(),S=r.lng();return{name:c,state:a,country:o,lat:p,lng:S,googlePlaceId:e.place_id||"",primaryName:d,secondaryName:m}}async function P(e,s){var a;if(!i.value||e.length<3){s([]);return}const t=window.google;if(!((a=t==null?void 0:t.maps)!=null&&a.places)){s([]);return}new t.maps.places.PlacesService(document.createElement("div")).textSearch({query:e},(o,c)=>{if(c===t.maps.places.PlacesServiceStatus.OK&&o){const d=o.map(r=>({name:r.name||e})),m=Array.from(new Map(d.map(r=>[r.name.toLowerCase(),{name:r.name||e}])).values());m.sort((r,p)=>r.name.length-p.name.length),m.length===0&&e.length>=3&&m.push({name:e}),s(m)}else e.length>=3?s([{name:e}]):s([])})}function f(){g=[]}return I(()=>{f()}),{isLoaded:i,isLoading:u,loadGoogleMapsScript:y,createAutocomplete:b,parsePlaceResult:h,searchOrganizations:P,cleanup:f}}export{A as u};
