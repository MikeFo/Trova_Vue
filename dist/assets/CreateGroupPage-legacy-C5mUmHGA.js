!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function l(e,o,a,i){var l=o&&o.prototype instanceof s?o:s,c=Object.create(l.prototype);return r(c,"_invoke",function(e,r,o){var a,i,l,s=0,c=o||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,r){return a=e,i=0,l=t,p.n=r,u}};function f(e,r){for(i=e,l=r,n=0;!d&&s&&!o&&n<c.length;n++){var o,a=c[n],f=p.p,v=a[2];e>3?(o=v===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(i=0,p.v=r,p.n=a[1]):f<v&&(o=e<3||a[0]>r||r>v)&&(a[4]=e,a[5]=r,p.n=v,i=0))}if(o||e>1)return u;throw d=!0,r}return function(o,c,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,v),i=c,l=v;(n=i<2?t:l)||!d;){a||(i?i<3?(i>1&&(p.n=-1),f(i,l)):p.n=l:p.v=l);try{if(s=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((n=(d=p.n<0)?l:e.call(r,p))!==u)break}catch(n){a=t,i=1,l=n}finally{s=1}}return{value:n,done:d}}}(e,a,i),!0),c}var u={};function s(){}function c(){}function d(){}n=Object.getPrototypeOf;var p=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),f=d.prototype=s.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=d,r(f,"constructor",d),r(d,"constructor",c),c.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(f),r(f,i,"Generator"),r(f,a,function(){return this}),r(f,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:v}})()}function r(e,t,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,t,n,o){function i(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},r(e,t,n,o)}function t(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function n(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach(function(r){o(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function o(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==a(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return l(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function u(e,r,t,n,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void t(e)}l.done?r(u):Promise.resolve(u).then(n,o)}System.register(["./index-legacy-D3_iwoP0.js","./group.service-legacy-CiCW_xct.js"],function(r,t){"use strict";var o,l,s,c,d,p,f,v,g,m,b,y,h,x,w,k,_,P,j,O,S,G,E,C,I,A,D,F,T,N,U,V,R,q,z,Y,L,J,M,$;return{setters:[function(e){o=e.F,l=e.v,s=e.y,c=e.r,d=e.a2,p=e.I,f=e.J,v=e.L,g=e.M,m=e.N,b=e.ak,y=e.aq,h=e.X,x=e.a6,w=e.ar,k=e.al,_=e.W,P=e.a8,j=e.am,O=e.O,S=e.ap,G=e.ae,E=e.Y,C=e.as,I=e.ag,A=e.ac,D=e.U,F=e.at,T=e.au,N=e.av,U=e.ao,V=e.Q,R=e.H,q=e.$,z=e.aw,Y=e.ax,L=e.ay,J=e.R,M=e.a0},function(e){$=e.groupService}],execute:function(){var t=document.createElement("style");t.textContent=".create-group-content[data-v-8809e275]{--background: #f8fafc}.create-group-container[data-v-8809e275]{padding:16px;max-width:600px;margin:0 auto}.form-section[data-v-8809e275]{background:#fff;border-radius:16px;padding:24px;margin-bottom:16px;box-shadow:0 2px 8px rgba(0,0,0,.04)}.section-label[data-v-8809e275]{font-size:18px;font-weight:600;color:#1a1a1a;margin-bottom:16px;display:block}.section-description[data-v-8809e275]{font-size:14px;color:#64748b;margin:0 0 12px}.form-item[data-v-8809e275]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;margin-bottom:16px}.error-message[data-v-8809e275]{color:#ef4444;font-size:14px;margin-top:-12px;margin-bottom:12px;padding-left:16px}.photo-upload-container[data-v-8809e275]{display:flex;justify-content:center;align-items:center;margin:16px 0}.photo-preview[data-v-8809e275]{position:relative;width:150px;height:150px;border-radius:12px;overflow:hidden;box-shadow:0 4px 16px rgba(0,0,0,.1)}.photo-preview img[data-v-8809e275]{width:100%;height:100%;object-fit:cover}.remove-photo[data-v-8809e275]{position:absolute;bottom:8px;right:8px}.photo-placeholder[data-v-8809e275]{width:150px;height:150px;border-radius:12px;border:3px dashed #d1d5db;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;color:#6b7280}.photo-placeholder[data-v-8809e275]:hover{border-color:#2d7a4e;background:#f0fdf4}.photo-placeholder ion-icon[data-v-8809e275]{font-size:48px;margin-bottom:8px}.tags-placeholder[data-v-8809e275]{margin-top:12px}.form-actions[data-v-8809e275]{margin-top:24px;padding:0 8px}.submit-button[data-v-8809e275]{--border-radius: 12px;--padding-top: 16px;--padding-bottom: 16px;height:52px;font-weight:600;font-size:16px;text-transform:none;--background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);--color: #ffffff;box-shadow:0 4px 12px rgba(52,168,83,.3);transition:all .2s ease}.submit-button[data-v-8809e275]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px rgba(52,168,83,.4)}.submit-button[data-v-8809e275]:active:not(:disabled){transform:translateY(0)}.submit-button[data-v-8809e275]:disabled{--background: #e5e7eb;--color: #94a3b8;box-shadow:none;opacity:.6}@media (min-width: 768px){.create-group-container[data-v-8809e275]{padding:24px}.form-section[data-v-8809e275]{padding:32px}}\n",document.head.appendChild(t);var H={class:"create-group-container"},Q={class:"form-section"},W={class:"photo-upload-container"},X={key:0,class:"photo-preview"},B=["src"],K={class:"form-section"},Z={key:0,class:"error-message"},ee={key:1,class:"error-message"},re={class:"form-section"},te={class:"form-section"},ne={class:"tags-placeholder"},oe={class:"form-actions"},ae=o({__name:"CreateGroupPage",setup:function(r){var t=R(),o=l(),M=s().storage,ae=c({name:"",bio:"",isPrivate:!1,tags:[],logo:null,logoFile:null}),ie=c({name:"",bio:""}),le=c(!1),ue=c(null),se=d(function(){return ae.value.name.trim().length>0&&ae.value.bio.trim().length>0});function ce(){t.back()}function de(){var e;null===(e=ue.value)||void 0===e||e.click()}function pe(e){var r,t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t){ae.value.logoFile=t;var n=new FileReader;n.onload=function(e){var r;ae.value.logo=null===(r=e.target)||void 0===r?void 0:r.result},n.readAsDataURL(t)}}function fe(){ae.value.logo=null,ae.value.logoFile=null,ue.value&&(ue.value.value="")}function ve(){ie.value={name:"",bio:""};var e=!0;return ae.value.name.trim()?ae.value.name.length>50&&(ie.value.name="Name must be 50 characters or less",e=!1):(ie.value.name="Name is required",e=!1),ae.value.bio.trim()?ae.value.bio.length>500&&(ie.value.bio="Description must be 500 characters or less",e=!1):(ie.value.bio="Description is required",e=!1),e}function ge(){return me.apply(this,arguments)}function me(){var r;return r=e().m(function r(){var i,l,u,s,c,d,p,f,v,g,m,b,y,h,x,w,k,_,P,j,O,S,G,E,C,I,A,D,F,T,N,U;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(ve()){e.n=1;break}return e.a(2);case 1:if(null!==(i=o.user)&&void 0!==i&&i.id){e.n=4;break}return e.n=2,q.create({message:"You must be logged in to create a group",duration:2e3,color:"danger"});case 2:return l=e.v,e.n=3,l.present();case 3:return e.a(2);case 4:if(le.value=!0,e.p=5,o.user){e.n=6;break}throw new Error("User not found");case 6:if(u=o.user,s=u.inDemoCommunityId||u.communityId||u.community_id||null){e.n=9;break}return e.n=7,q.create({message:"You must be part of a community to create a group. Please join a community first.",duration:4e3,color:"warning"});case 7:return c=e.v,e.n=8,c.present();case 8:return le.value=!1,e.a(2);case 9:if(d=void 0,!ae.value.logoFile||!M){e.n=15;break}return e.p=10,p=o.user.id,f="group_".concat(p,"_").concat(Date.now()),v=z(M,"images/".concat(f)),e.n=11,Y(v,ae.value.logoFile);case 11:return e.n=12,L(v);case 12:d=e.v,e.n=15;break;case 13:return e.p=13,T=e.v,console.error("Error uploading logo:",T),e.n=14,q.create({message:T.message||"Failed to upload logo. Creating group without logo.",duration:3e3,color:"warning"});case 14:return g=e.v,e.n=15,g.present();case 15:if(m={name:ae.value.name.trim(),bio:ae.value.bio.trim(),leaderId:o.user.id,communityId:s,isPrivate:ae.value.isPrivate,tags:ae.value.tags&&ae.value.tags.length>0?ae.value.tags:[]},d&&d.trim().length>0)try{new URL(d),m.logo=d}catch(r){console.warn("Invalid logo URL, creating group without logo:",r)}console.log("Creating group with data:",JSON.stringify(m,null,2)),console.log("Data types:",{name:a(m.name),bio:a(m.bio),leaderId:a(m.leaderId),communityId:a(m.communityId),isPrivate:a(m.isPrivate),tags:Array.isArray(m.tags),logo:m.logo?a(m.logo):"undefined"}),b=null,y=0,h=2;case 16:if(b||!(y<=h)){e.n=29;break}return e.p=17,e.n=18,$.createGroup(m);case 18:return b=e.v,e.a(3,29);case 19:if(e.p=19,N=e.v,!(++y>h)){e.n=20;break}throw N;case 20:if(500!==N.status||!d||1!==y){e.n=27;break}return console.warn("First attempt failed with logo, retrying without logo..."),delete(x=n({},m)).logo,e.p=21,e.n=22,$.createGroup(x);case 22:return b=e.v,e.n=23,q.create({message:"Group created successfully (logo upload will be processed separately)",duration:3e3,color:"warning"});case 23:return w=e.v,e.n=24,w.present();case 24:return e.a(3,29);case 25:e.p=25,e.v,console.warn("Retry without logo also failed, trying again with original data...");case 26:e.n=28;break;case 27:return e.n=28,new Promise(function(e){return setTimeout(e,500*y)});case 28:e.n=16;break;case 29:if(b){e.n=30;break}throw new Error("Group creation failed after retries");case 30:return e.n=31,q.create({message:"Group created successfully!",duration:2e3,color:"success"});case 31:return k=e.v,e.n=32,k.present();case 32:return e.n=33,new Promise(function(e){return setTimeout(e,300)});case 33:t.push("/tabs/groups"),e.n=36;break;case 34:return e.p=34,U=e.v,console.error("Error creating group:",U),console.error("Error details:",{message:U.message,stack:U.stack,response:U.response||(null===(_=U.originalError)||void 0===_?void 0:_.response),status:U.status||(null===(P=U.originalError)||void 0===P||null===(P=P.response)||void 0===P?void 0:P.status),responseData:(null===(j=U.response)||void 0===j?void 0:j.data)||(null===(O=U.originalError)||void 0===O||null===(O=O.response)||void 0===O?void 0:O.data)}),I="Failed to create group. Please try again.",U.message&&"{}"!==U.message&&"Request failed"!==U.message?I=U.message:null!==(S=U.response)&&void 0!==S&&S.data?(A=U.response.data).message&&"{}"!==A.message?I=A.message:A.error&&(I=A.error):null!==(G=U.originalError)&&void 0!==G&&null!==(G=G.response)&&void 0!==G&&G.data&&((D=U.originalError.response.data).message&&"{}"!==D.message?I=D.message:D.error&&(I=D.error)),500===(U.status||(null===(E=U.originalError)||void 0===E||null===(E=E.response)||void 0===E?void 0:E.status)||(null===(C=U.response)||void 0===C?void 0:C.status))&&(I="Server error occurred. Please check that all required fields are filled and try again."),e.n=35,q.create({message:I,duration:4e3,color:"danger"});case 35:return F=e.v,e.n=36,F.present();case 36:return e.p=36,le.value=!1,e.f(36);case 37:return e.a(2)}},r,null,[[21,25],[17,19],[10,13],[5,34,36,37]])}),me=function(){var e=this,t=arguments;return new Promise(function(n,o){var a=r.apply(e,t);function i(e){u(a,n,o,i,l,"next",e)}function l(e){u(a,n,o,i,l,"throw",e)}i(void 0)})},me.apply(this,arguments)}return function(e,r){return J(),p(v(g),null,{default:f(function(){return[m(v(j),null,{default:f(function(){return[m(v(b),null,{default:f(function(){return[m(v(y),{slot:"start"},{default:f(function(){return[m(v(h),{onClick:ce},{default:f(function(){return[m(v(x),{icon:v(w)},null,8,["icon"])]}),_:1})]}),_:1}),m(v(k),null,{default:f(function(){return i(r[3]||(r[3]=[_("Create Group",-1)]))}),_:1}),m(v(y),{slot:"end"},{default:f(function(){return[m(v(h),{onClick:ge,disabled:!se.value||le.value},{default:f(function(){return[_(P(le.value?"Creating...":"Create"),1)]}),_:1},8,["disabled"])]}),_:1})]}),_:1})]}),_:1}),m(v(V),{fullscreen:!0,class:"create-group-content"},{default:f(function(){return[O("div",H,[O("form",{onSubmit:S(ge,["prevent"])},[O("div",Q,[m(v(G),{class:"section-label"},{default:f(function(){return i(r[4]||(r[4]=[_("Group Photo",-1)]))}),_:1}),O("div",W,[ae.value.logo?(J(),E("div",X,[O("img",{src:ae.value.logo,alt:"Group logo"},null,8,B),m(v(h),{fill:"clear",size:"small",onClick:fe,class:"remove-photo"},{default:f(function(){return i(r[5]||(r[5]=[_(" Remove ",-1)]))}),_:1})])):(J(),E("div",{key:1,class:"photo-placeholder",onClick:de},[m(v(x),{icon:v(C)},null,8,["icon"]),r[6]||(r[6]=O("p",null,"Tap to add photo",-1))])),O("input",{ref_key:"fileInput",ref:ue,type:"file",accept:"image/*",onChange:pe,style:{display:"none"}},null,544)])]),O("div",K,[m(v(G),{class:"section-label"},{default:f(function(){return i(r[7]||(r[7]=[_("Group Information",-1)]))}),_:1}),m(v(A),{class:"form-item",lines:"full"},{default:f(function(){return[m(v(G),{position:"stacked"},{default:f(function(){return i(r[8]||(r[8]=[_("Group Name",-1)]))}),_:1}),m(v(D),{modelValue:ae.value.name,"onUpdate:modelValue":r[0]||(r[0]=function(e){return ae.value.name=e}),placeholder:"New Group Name",maxlength:50,required:""},null,8,["modelValue"])]}),_:1}),ie.value.name?(J(),E("div",Z,P(ie.value.name),1)):I("",!0),m(v(A),{class:"form-item",lines:"full"},{default:f(function(){return[m(v(G),{position:"stacked"},{default:f(function(){return i(r[9]||(r[9]=[_("Description",-1)]))}),_:1}),m(v(F),{modelValue:ae.value.bio,"onUpdate:modelValue":r[1]||(r[1]=function(e){return ae.value.bio=e}),placeholder:"Group Description",maxlength:500,rows:4,required:""},null,8,["modelValue"])]}),_:1}),ie.value.bio?(J(),E("div",ee,P(ie.value.bio),1)):I("",!0)]),O("div",re,[m(v(G),{class:"section-label"},{default:f(function(){return i(r[10]||(r[10]=[_("Privacy",-1)]))}),_:1}),m(v(T),{modelValue:ae.value.isPrivate,"onUpdate:modelValue":r[2]||(r[2]=function(e){return ae.value.isPrivate=e})},{default:f(function(){return[m(v(A),{lines:"none"},{default:f(function(){return[m(v(N),{slot:"start",value:!1}),m(v(G),null,{default:f(function(){return i(r[11]||(r[11]=[O("h3",null,"Public",-1),O("p",null,"Anyone can find and join this group",-1)]))}),_:1})]}),_:1}),m(v(A),{lines:"none"},{default:f(function(){return[m(v(N),{slot:"start",value:!0}),m(v(G),null,{default:f(function(){return i(r[12]||(r[12]=[O("h3",null,"Private",-1),O("p",null,"Only invited members can join",-1)]))}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]),O("div",te,[m(v(G),{class:"section-label"},{default:f(function(){return i(r[13]||(r[13]=[_("Tags",-1)]))}),_:1}),r[15]||(r[15]=O("p",{class:"section-description"},"Add tags to help people find your group",-1)),O("div",ne,[m(v(h),{fill:"outline",size:"small"},{default:f(function(){return[m(v(x),{icon:v(U),slot:"start"},null,8,["icon"]),r[14]||(r[14]=_(" Add Tags ",-1))]}),_:1})])]),O("div",oe,[m(v(h),{expand:"block",onClick:ge,disabled:!se.value||le.value,class:"submit-button"},{default:f(function(){return[_(P(le.value?"Creating...":"Create Group"),1)]}),_:1},8,["disabled"])])],32)])]}),_:1})]}),_:1})}}});r("default",M(ae,[["__scopeId","data-v-8809e275"]]))}}})}();
