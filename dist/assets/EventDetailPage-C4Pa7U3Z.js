import{F as U,v as $,r as b,a2 as M,G,I as g,J as i,L as a,M as H,a3 as z,$ as v,N as o,ak as J,aq as I,X as f,a6 as c,aB as Y,al as q,W as h,ag as p,aC as R,am as K,Y as r,O as n,Z as Q,a8 as d,aD as W,aE as X,aF as Z,aG as j,aH as ee,aI as te,aJ as ae,aa as ne,ab as se,an as oe,aK as le,aL as ie,aM as re,Q as ue,H as ce,R as l,a0 as de}from"./index-CkJ7yJ3n.js";import{eventService as y}from"./event.service-D7cjacjh.js";const ve={key:0,class:"loading-container"},fe={key:1,class:"event-detail-container"},pe={key:0,class:"event-photo-section"},_e=["src","alt"],me={class:"event-header"},ge={class:"event-title"},he={class:"event-meta-top"},ye={class:"event-date-time"},ke={class:"date-display"},we={class:"time-display"},Ce={key:0,class:"time-end"},be={key:0,class:"event-location"},Se={class:"event-actions-bar"},Ee={class:"action-buttons"},Pe={key:1,class:"event-section"},Ie={class:"event-description"},Re={class:"event-section"},Oe={class:"section-title"},Be={class:"attendee-count"},Te={key:0,class:"attendees-list"},Ve=["onClick"],xe={class:"attendee-avatar"},De=["src","alt"],Ne={key:1,class:"avatar-placeholder"},Le={class:"attendee-name"},Ae={key:1,class:"empty-attendees"},Fe={class:"event-section"},Ue={class:"info-grid"},$e={class:"info-item"},Me={class:"info-value"},Ge={key:0,class:"info-item"},He={key:1,class:"info-item"},ze={key:2,class:"error-container"},Je=U({__name:"EventDetailPage",setup(Ye){const w=ce(),O=z(),_=$(),e=b(null),k=b(!0),m=b(!1),B=M(()=>{var s;return e.value&&((s=_.user)==null?void 0:s.id)===e.value.createdBy});async function C(){const s=O.params.id;if(!s||typeof s!="string"){k.value=!1;return}k.value=!0;try{const t=await y.getEvent(s);e.value=t}catch(t){console.error("Error loading event:",t),await(await v.create({message:"Failed to load event",duration:2e3,color:"danger"})).present()}finally{k.value=!1}}function S(){w.back()}function T(s){return new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function E(s){return new Date(s).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function V(s){const t=s.split(" ");return t.length>=2?(t[0][0]+t[t.length-1][0]).toUpperCase():s.substring(0,2).toUpperCase()}function x(s){w.push("/tabs/profile/".concat(s))}async function D(){var s;if(!(!((s=_.user)!=null&&s.id)||!e.value)){m.value=!0;try{await y.rsvpToEvent(e.value.id,_.user.id),e.value&&(e.value.userAttending=!0,e.value.attendeeCount=(e.value.attendeeCount||0)+1),await(await v.create({message:"You're going to this event!",duration:2e3,color:"success"})).present(),await C()}catch(t){console.error("Error RSVPing to event:",t),await(await v.create({message:"Failed to RSVP. Please try again.",duration:2e3,color:"danger"})).present()}finally{m.value=!1}}}async function N(){var s;if(!(!((s=_.user)!=null&&s.id)||!e.value)){m.value=!0;try{await y.cancelRsvp(e.value.id,_.user.id),e.value&&(e.value.userAttending=!1,e.value.attendeeCount=Math.max(0,(e.value.attendeeCount||1)-1)),await(await v.create({message:"RSVP canceled",duration:2e3,color:"medium"})).present(),await C()}catch(t){console.error("Error canceling RSVP:",t),await(await v.create({message:"Failed to cancel RSVP. Please try again.",duration:2e3,color:"danger"})).present()}finally{m.value=!1}}}async function P(){if(e.value)try{const s=await y.shareEvent(e.value.id);navigator.share?await navigator.share({title:e.value.name,text:e.value.description||"Check out this event: ".concat(e.value.name),url:s}):(await navigator.clipboard.writeText(s),await(await v.create({message:"Event URL copied to clipboard!",duration:2e3,color:"success"})).present())}catch(s){console.error("Error sharing event:",s)}}async function L(){var s,t;if(!(!((s=_.user)!=null&&s.id)||!e.value))try{await y.toggleSaveEvent(e.value.id,_.user.id),e.value&&(e.value.userSaved=!e.value.userSaved),await(await v.create({message:(t=e.value)!=null&&t.userSaved?"Event saved!":"Event unsaved",duration:2e3,color:"success"})).present()}catch(u){console.error("Error saving event:",u),await(await v.create({message:"Failed to save event. Please try again.",duration:2e3,color:"danger"})).present()}}function A(){e.value&&w.push("/tabs/events/".concat(e.value.id,"/edit"))}return G(()=>{C()}),(s,t)=>(l(),g(a(H),null,{default:i(()=>[o(a(K),null,{default:i(()=>[o(a(J),null,{default:i(()=>[o(a(I),{slot:"start"},{default:i(()=>[o(a(f),{onClick:S},{default:i(()=>[o(a(c),{icon:a(Y)},null,8,["icon"])]),_:1})]),_:1}),o(a(q),null,{default:i(()=>[...t[0]||(t[0]=[h("Event Details",-1)])]),_:1}),o(a(I),{slot:"end"},{default:i(()=>[e.value?(l(),g(a(f),{key:0,onClick:P},{default:i(()=>[o(a(c),{icon:a(R)},null,8,["icon"])]),_:1})):p("",!0)]),_:1})]),_:1})]),_:1}),o(a(ue),{fullscreen:!0,class:"event-detail-content"},{default:i(()=>[k.value?(l(),r("div",ve,[o(a(Q)),t[1]||(t[1]=n("p",null,"Loading event...",-1))])):e.value?(l(),r("div",fe,[e.value.photo?(l(),r("div",pe,[n("img",{src:e.value.photo,alt:e.value.name,class:"event-photo"},null,8,_e)])):p("",!0),n("div",me,[n("h1",ge,d(e.value.name),1),n("div",he,[n("div",ye,[o(a(c),{icon:a(W)},null,8,["icon"]),n("div",null,[n("div",ke,d(T(e.value.startTime)),1),n("div",we,d(E(e.value.startTime)),1),e.value.endTime?(l(),r("div",Ce," - "+d(E(e.value.endTime)),1)):p("",!0)])]),e.value.location?(l(),r("div",be,[o(a(c),{icon:a(X)},null,8,["icon"]),n("span",null,d(e.value.location),1)])):p("",!0)])]),n("div",Se,[e.value.userAttending?(l(),g(a(f),{key:1,fill:"outline",expand:"block",class:"cancel-rsvp-button",onClick:N,disabled:m.value},{default:i(()=>[o(a(c),{icon:a(j),slot:"start"},null,8,["icon"]),t[3]||(t[3]=h(" Cancel RSVP ",-1))]),_:1},8,["disabled"])):(l(),g(a(f),{key:0,fill:"solid",expand:"block",class:"rsvp-button",onClick:D,disabled:m.value},{default:i(()=>[o(a(c),{icon:a(Z),slot:"start"},null,8,["icon"]),t[2]||(t[2]=h(" RSVP ",-1))]),_:1},8,["disabled"])),n("div",Ee,[o(a(f),{fill:"clear",class:"icon-button",onClick:L,color:e.value.userSaved?"primary":"medium"},{default:i(()=>[o(a(c),{icon:e.value.userSaved?a(ee):a(te)},null,8,["icon"])]),_:1},8,["color"]),o(a(f),{fill:"clear",class:"icon-button",onClick:P},{default:i(()=>[o(a(c),{icon:a(R)},null,8,["icon"])]),_:1}),B.value?(l(),g(a(f),{key:0,fill:"clear",class:"icon-button",onClick:A},{default:i(()=>[o(a(c),{icon:a(ae)},null,8,["icon"])]),_:1})):p("",!0)])]),e.value.description?(l(),r("div",Pe,[t[4]||(t[4]=n("h2",{class:"section-title"},"About this event",-1)),n("p",Ie,d(e.value.description),1)])):p("",!0),n("div",Re,[n("h2",Oe,[t[5]||(t[5]=h(" Attendees ",-1)),n("span",Be,"("+d(e.value.attendeeCount||0)+")",1)]),e.value.attendees&&e.value.attendees.length>0?(l(),r("div",Te,[(l(!0),r(ne,null,se(e.value.attendees,u=>(l(),r("div",{key:u.id,class:"attendee-item",onClick:F=>x(u.id)},[n("div",xe,[u.profilePicture?(l(),r("img",{key:0,src:u.profilePicture,alt:u.fullName},null,8,De)):(l(),r("div",Ne,d(V(u.fullName)),1))]),n("span",Le,d(u.fullName),1)],8,Ve))),128))])):(l(),r("div",Ae,[...t[6]||(t[6]=[n("p",null,"No attendees yet. Be the first to RSVP!",-1)])]))]),n("div",Fe,[t[10]||(t[10]=n("h2",{class:"section-title"},"Event Information",-1)),n("div",Ue,[n("div",$e,[o(a(c),{icon:a(oe)},null,8,["icon"]),n("div",null,[t[7]||(t[7]=n("div",{class:"info-label"},"Attendees",-1)),n("div",Me,d(e.value.attendeeCount||0)+" going",1)])]),e.value.isPrivate?(l(),r("div",Ge,[o(a(c),{icon:a(le)},null,8,["icon"]),t[8]||(t[8]=n("div",null,[n("div",{class:"info-label"},"Privacy"),n("div",{class:"info-value"},"Private Event")],-1))])):p("",!0),e.value.createdBy?(l(),r("div",He,[o(a(c),{icon:a(ie)},null,8,["icon"]),t[9]||(t[9]=n("div",null,[n("div",{class:"info-label"},"Organized by"),n("div",{class:"info-value"},"Event Organizer")],-1))])):p("",!0)])])])):(l(),r("div",ze,[o(a(c),{icon:a(re),class:"error-icon"},null,8,["icon"]),t[12]||(t[12]=n("h2",null,"Event not found",-1)),t[13]||(t[13]=n("p",null,"The event you're looking for doesn't exist or has been removed.",-1)),o(a(f),{onClick:S},{default:i(()=>[...t[11]||(t[11]=[h("Go Back",-1)])]),_:1})]))]),_:1})]),_:1}))}}),Qe=de(Je,[["__scopeId","data-v-e719e061"]]);export{Qe as default};
